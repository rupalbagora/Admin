import{n as F,b as c,j as e,u as J,a as Q,o as E,p as W,q as D,t as M,v as R}from"./index-BUwxZ0dz.js";import{F as o,I as u,B as j}from"./index-D91Dgcjk.js";import{S as U,R as X}from"./UploadOutlined-BZUwM306.js";import{D as Z}from"./index-CwvPk9S2.js";import{U as V,F as ee,P as se,R as te}from"./DeleteOutlined-CY-A2Q_x.js";import{I as L,s as S,C as ae}from"./AntdIcon-D9VCaoNQ.js";import{M as re}from"./index-HnUezucs.js";import{A as le}from"./index-Dwz_pUyK.js";import{T as ne,R as ie}from"./EditOutlined-BMN32wtQ.js";import{S as ce}from"./index-DenBw2B0.js";import"./objectWithoutPropertiesLoose-k0w7FEql.js";var y={},_;function oe(){if(_)return y;_=1,Object.defineProperty(y,"__esModule",{value:!0});var t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"};return y.default=t,y}var de=oe();const ue=F(de);function O(){return O=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var l=arguments[r];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n])}return t},O.apply(this,arguments)}const me=(t,r)=>c.createElement(L,O({},t,{ref:r,icon:ue})),he=c.forwardRef(me);var C={},q;function pe(){if(q)return C;q=1,Object.defineProperty(C,"__esModule",{value:!0});var t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"};return C.default=t,C}var fe=pe();const xe=F(fe);function I(){return I=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var l=arguments[r];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n])}return t},I.apply(this,arguments)}const ge=(t,r)=>c.createElement(L,I({},t,{ref:r,icon:xe})),je=c.forwardRef(ge),{Option:d}=U,ve=({initialValues:t,onSubmit:r,isEditMode:l,loading:n})=>{const[m]=o.useForm(),[h,p]=c.useState((t==null?void 0:t.subscriptionPeriod)==="custom"),v=i=>{p(i==="custom")},f=i=>{const x={...i,isActive:i.status==="active",avatar:i.image&&i.image[0]?URL.createObjectURL(i.image[0].originFileObj):(t==null?void 0:t.avatar)||"",expireDate:h&&i.customDate?i.customDate.toISOString():void 0};r(x)};return e.jsx("div",{className:"bg-white p-6 rounded-xl",children:e.jsxs(o,{layout:"vertical",form:m,onFinish:f,initialValues:t,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(o.Item,{label:"Name",name:"firstName",rules:[{required:!0,message:"Please enter name"}],children:e.jsx(u,{placeholder:"Enter name",size:"large"})}),e.jsx(o.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(u,{placeholder:"example@email.com",size:"large"})}),!l&&e.jsx(o.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please enter password"},{min:8,message:"Password must be at least 8 characters"}],children:e.jsx(u.Password,{placeholder:"Enter password",size:"large"})}),e.jsx(o.Item,{label:"Phone",name:"phone",rules:[{required:!0,message:"Please enter phone number"}],children:e.jsx(u,{placeholder:"Enter phone number",size:"large"})}),e.jsx(o.Item,{label:"Address",name:"address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(u,{placeholder:"Enter address",size:"large"})}),e.jsx(o.Item,{label:"Status",name:"status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(U,{placeholder:"-- Select --",size:"large",children:[e.jsx(d,{value:"active",children:"Active"}),e.jsx(d,{value:"inactive",children:"Inactive"})]})}),e.jsx(o.Item,{label:"Subscription Period",name:"subscriptionPeriod",rules:[{required:!0,message:"Please select subscription"}],children:e.jsxs(U,{onChange:v,size:"large",placeholder:"Select subscription",children:[e.jsx(d,{value:"biannual",children:"Bi-Annual"}),e.jsx(d,{value:"halfyearly",children:"Half-Yearly"}),e.jsx(d,{value:"yearly",children:"Yearly"}),e.jsx(d,{value:"custom",children:"Custom"})]})}),h&&e.jsx(o.Item,{label:"Custom Expiry Date",name:"customDate",rules:[{required:!0,message:"Please select custom date"}],children:e.jsx(Z,{className:"w-full",size:"large",placeholder:"Select custom date"})}),e.jsx(o.Item,{label:"Image",name:"image",valuePropName:"fileList",getValueFromEvent:i=>i.fileList,className:"md:col-span-2",children:e.jsx(V,{beforeUpload:()=>!1,listType:"picture-card",maxCount:1,children:e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("div",{className:"mt-2 text-gray-600",children:"Upload Image"})]})})}),e.jsx("div",{className:"md:col-span-2 flex justify-end mt-4",children:e.jsx(j,{type:"primary",htmlType:"submit",size:"large",loading:n,className:"px-10 py-2 rounded-lg shadow-sm bg-blue-600 hover:bg-blue-700",children:l?"Update":"Create"})})]})})},{Search:be}=u,Ee=()=>{const t=J(),{users:r,loading:l,error:n}=Q(s=>s.users),[m,h]=c.useState(""),[p,v]=c.useState(1),[f,i]=c.useState(10),[x,P]=c.useState(null),[T,g]=c.useState(!1),[w,N]=c.useState(!1);c.useEffect(()=>{const s=t(E());return()=>s.abort()},[t]),c.useEffect(()=>{n&&(S.error(n),t(W()))},[n,t]);const A=r.filter(s=>s.role==="admin").filter(s=>s.email.toLowerCase().includes(m.toLowerCase())||s.firstName.toLowerCase().includes(m.toLowerCase())||s.lastName.toLowerCase().includes(m.toLowerCase())),$=A.slice((p-1)*f,p*f),k=s=>{h(s),v(1)},B=s=>{P(s),N(!0),g(!0)},Y=()=>{P(null),N(!1),g(!0)},H=async s=>{const a=await t(R(s));R.fulfilled.match(a)&&S.success("User deleted successfully")},K=async s=>{if(w&&x){const a=await t(D({id:x._id,data:s}));D.fulfilled.match(a)&&(S.success("User updated successfully"),g(!1))}else{const a=await t(M(s));M.fulfilled.match(a)&&(S.success("User created successfully"),t(E()),g(!1))}},G=[{title:"S.No",key:"sno",render:(s,a,b)=>b+1},{title:"Image",key:"avatar",render:(s,a)=>{var b,z;return e.jsxs(le,{src:a.avatar,size:50,children:[(b=a.firstName)==null?void 0:b[0],(z=a.lastName)==null?void 0:z[0]]})}},{title:"Admin",key:"admin",render:(s,a)=>e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[a.firstName," ",a.lastName]}),e.jsx("div",{className:"text-gray-500 text-sm",children:a.email})]})},{title:"Status",dataIndex:"isActive",key:"status",render:s=>e.jsx(ne,{color:s?"green":"red",children:s?"Active":"Inactive"})},{title:"Expire Date",dataIndex:"expireDate",key:"expireDate",render:s=>s?new Date(s).toLocaleDateString():"-"},{title:"Actions",key:"actions",render:(s,a)=>e.jsxs(ce,{size:"middle",children:[e.jsx(j,{icon:e.jsx(ie,{}),onClick:()=>B(a)}),e.jsx(se,{title:"Are you sure to delete this user?",onConfirm:()=>H(a._id),okText:"Yes",cancelText:"No",children:e.jsx(j,{danger:!0,icon:e.jsx(te,{})})})]})}];return e.jsxs("div",{className:"p-6",children:[e.jsxs(ae,{title:"Subadmin Management",extra:e.jsx(j,{className:"bg-gray-700",type:"primary",icon:e.jsx(je,{}),onClick:Y,children:"Add Subadmin"}),children:[e.jsx("div",{className:"mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsx(be,{placeholder:"Search users...",allowClear:!0,enterButton:e.jsx(j,{type:"primary",icon:e.jsx(he,{})}),size:"large",onSearch:k,onChange:s=>h(s.target.value),className:"w-full md:w-1/2 bg-[#2523232c]"})}),e.jsx(ee,{columns:G,dataSource:$,rowKey:"_id",loading:l,pagination:{current:p,pageSize:f,total:A.length,showSizeChanger:!0,pageSizeOptions:["10","20","50"],onChange:(s,a)=>{v(s),i(a||10)}}})]}),e.jsx(re,{title:w?"Edit User":"Create Subadmin",visible:T,onCancel:()=>g(!1),footer:null,width:800,destroyOnClose:!0,children:e.jsx(ve,{initialValues:x||void 0,onSubmit:K,isEditMode:w,loading:l})})]})};export{Ee as default};
